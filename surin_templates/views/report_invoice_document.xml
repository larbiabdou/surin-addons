<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="paperformat_a4_custom" model="report.paperformat">
        <field name="name">Custom A4</field>
        <field name="default" eval="True" />
        <field name="format">A4</field>
        <field name="page_height">0</field>
        <field name="page_width">0</field>
        <field name="orientation">Portrait</field>
        <field name="margin_top">10</field>
        <field name="margin_bottom">32</field>
        <field name="margin_left">7</field>
        <field name="margin_right">7</field>
        <field name="header_line" eval="False" />
        <field name="header_spacing">5</field>
        <field name="dpi">90</field>
    </record>
    <record id="account.account_invoices" model="ir.actions.report">
        <field name="paperformat_id" ref="paperformat_a4_custom"/>
    </record>
    <record id="account.account_invoices_without_payment" model="ir.actions.report">
        <field name="paperformat_id" ref="paperformat_a4_custom"/>
    </record>

    <template id="report_invoice_document" inherit_id="account.report_invoice_document">
        <xpath expr="//div[hasclass('row')]" position="replace">
            <div class="row zero_min_height" style="border-bottom: 1px solid black; margin-bottom: 10px">
                <div class="col-6">
                    <span t-if="not proforma"></span>
                    <span t-else="">PROFORMA</span>
                    <span t-if="o.move_type == 'out_invoice' and o.state == 'posted'">Invoice</span>
                    <span t-elif="o.move_type == 'out_invoice' and o.state == 'draft'">Draft Invoice</span>
                    <span t-elif="o.move_type == 'out_invoice' and o.state == 'cancel'">Cancelled Invoice</span>
                    <span t-elif="o.move_type == 'out_refund' and o.state == 'posted'">Credit Note</span>
                    <span t-elif="o.move_type == 'out_refund' and o.state == 'draft'">Draft Credit Note</span>
                    <span t-elif="o.move_type == 'out_refund' and o.state == 'cancel'">Cancelled Credit Note</span>
                    <span t-elif="o.move_type == 'in_refund'">Vendor Credit Note</span>
                    <span t-elif="o.move_type == 'in_invoice'">Vendor Bill</span>
                </div>
                <div class="col-6 text-end">
                    <span t-if="o.name != '/'" t-field="o.name">INV/2023/0001</span>
                </div>
            </div>
            <div style="padding-bottom: 10px; border-bottom:1px solid black">
                <table class="invoice-table">
                    <tr>
                        <td style="width:48%">
                            <span t-if="o.move_type == 'out_invoice'">Fournisseur:</span>
                    <span t-elif="o.move_type == 'in_invoice'">Client:</span>
                        </td>
                        <td style="width:4%"></td>
                        <td style="width:48%">
                            <span t-if="o.move_type == 'in_invoice'">Fournisseur:</span>
                    <span t-elif="o.move_type == 'out_invoice'">Client:</span>
                        </td>
                    </tr>
                    <tr>
                            <td style="border: 1px solid black !important;padding: 5px; width:48%">
                                <address class="mb-0" t-field="o.company_id.partner_id"  t-options='{"widget": "contact", "fields": ["address", "name"], "no_marker": True}'/>
                                <t t-if="o.is_fictitious == True and o.sale_type == 'type_1'">
                                    <t t-if="o.company_id.rc_1">RC: <span t-field="o.company_id.rc_1"/></t> <br/>
                                    <t t-if="o.company_id.ai_1">AI: <span t-field="o.company_id.ai_1"/></t> <br/>
                                    <t t-if="o.company_id.nif_1">NIF: <span t-field="o.company_id.nif_1"/></t> <br/>
                                    <t t-if="o.company_id.nis_1">NIS: <span t-field="o.company_id.nis_1"/></t> <br/>
                                </t>
                                <t t-if="o.is_fictitious == True and o.sale_type == 'type_2'">
                                    <t t-if="o.company_id.rc_2">RC: <span t-field="o.company_id.rc_2"/></t> <br/>
                                    <t t-if="o.company_id.ai_2">AI: <span t-field="o.company_id.ai_2"/></t> <br/>
                                    <t t-if="o.company_id.nif_2">NIF: <span t-field="o.company_id.nif_2"/></t> <br/>
                                    <t t-if="o.company_id.nis_2">NIS: <span t-field="o.company_id.nis_2"/></t> <br/>
                                </t>
                            </td>
                            <td></td>
                            <td style="border: 1px solid black !important;padding: 5px; width:48%">
                                <address class="mb-0" t-field="o.partner_id" t-options='{"widget": "contact", "fields": ["address", "name"], "no_marker": True}'/>
                                <t t-if="o.partner_id.rc">RC: <span t-field="o.partner_id.rc"/></t> <br/>
                                <t t-if="o.partner_id.ai">AI: <span t-field="o.partner_id.ai"/></t> <br/>
                                <t t-if="o.partner_id.nif">NIF: <span t-field="o.partner_id.nif"/></t> <br/>
                                <t t-if="o.partner_id.nis">NIS: <span t-field="o.partner_id.nis"/></t> <br/>
                            </td>
                    </tr>
                </table>

            </div>
            <div style="padding-bottom: 10px; border-bottom:1px solid black">
                <table class="invoice-table" style="margin-top: 10px;">
                    <tr>
                        <td style="border-right: 1px solid black !important;padding: 5px; width:50%">
                            <t t-if="o.company_id.partner_id.bank_ids">
                                <t t-set="bank" t-value="o.company_id.partner_id.bank_ids[0]"/>
                            <t t-if="bank.acc_number"> Compte bancaire: <span t-field="bank.acc_number"/></t> <br/>
                            <t t-if="bank.bank_id">Banque: <span t-field="bank.bank_id.name"/></t> <br/>
                            <t t-if="bank.bank_id">NIB: <span t-field="bank.bank_id.bic"/></t> <br/>
                            <t t-if="bank.bank_id">SWIFT: <span t-field="bank.bank_id.swift"/></t> <br/>
                            </t>

                        </td>
                        <td style="border-left: 1px solid black !important;padding: 5px; width:50%">
                            <t t-if="o.is_fictitious == True">
                                <t t-set="payments_vals" t-value="o.sudo().invoice_payments_widget and o.sudo().invoice_payments_widget['content'] or []"/>
                                <t t-foreach="payments_vals" t-as="payment_vals">
                                    <t t-set="payment" t-value="o.sudo().env['account.payment'].search([('id', '=', payment_vals['account_payment_id'])])"/>

                                    Paiement: <span t-esc="payment.name"/> <br/>
                                    Date du paiement: <span t-esc="payment_vals['date']"/> <br/>
                                    Montant: <span t-esc="payment_vals['amount']"/> <br/>
                                </t>
                            </t>
                            <t t-else="">
                                <strong>Invoice Date:</strong><span t-field="o.invoice_date">2023-09-12</span> <br/>
                                <strong>Due Date:</strong><span t-field="o.invoice_date_due">2023-10-31</span> <br/>
                                <strong>Delivery Date:</strong><span t-field="o.delivery_date">2023-09-25</span><br/>
                                <strong>Source:</strong><span t-field="o.invoice_origin"></span>
                            </t>
                        </td>
                    </tr>
                </table>
            </div>

        </xpath>
    </template>
</odoo>